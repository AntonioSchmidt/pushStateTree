/*!
 * ! PushStateTree - v0.15.0 - 2016-03-29
 * * https://github.com/gartz/pushStateTree/
 * * Copyright (c) 2016 Gabriel Reitz Giannattasio <gabriel@gartz.com.br>; Licensed undefined
 */
!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){!function(e){"use strict";function n(t){return!isNaN(parseFloat(t))&&t%1===0&&isFinite(t)}function i(t,e,n){Object.defineProperty(t,e,{get:function(){return n},set:function(){}})}function r(t){return/^[a-z0-9]+:\/\//i.test(t)}function o(t){return/^[^#\/]/.test(t)}function a(t){for(var e=t.split("/"),n=1;n<e.length;)".."===e[n]&&n>0&&".."!==e[n-1]&&(e.splice(n-1,2),n-=2),n++;return e.join("/").replace(/\/\.\/|\.\/|\.\.\//g,"/").replace(/^\/$/,"")}function s(t){function n(t){if("function"==typeof s.prototype[t])r[t]=function(){return s.prototype[t].apply(this,arguments)};else{if("undefined"!=typeof r[t])return;Object.defineProperty(r,t,{get:function(){return s.prototype[t]},set:function(e){s.prototype[t]=e}})}}if(t=t||{},t[v]=t[v]!==!1,!(this instanceof A))return s.apply(u.createElement("pushstatetree-route"),arguments);var r=this;this.VERSION="0.15.0";for(var o in t)t.hasOwnProperty(o)&&(r[o]=t[o]);if(s.prototype[y]){var a=t[v];Object.defineProperty(r,v,{get:function(){return a},set:function(t){a=t!==!1}})}else i(r,v,!1);Object.defineProperty(r,"beautifyLocation",{get:function(){return s.prototype.beautifyLocation&&a},set:function(t){s.prototype.beautifyLocation=t===!0}}),r.beautifyLocation=t.beautifyLocation&&r.usePushState;var c;Object.defineProperty(r,"basePath",{get:function(){return c},set:function(t){c=t||"","/"!==c[0]&&(c="/"+c)}}),r.basePath=t.basePath;for(var h in s.prototype)s.prototype.hasOwnProperty(h)&&n(h);i(r,"length",e.history.length),i(r,"state",e.history.state);var d={url:"",uri:""};Object.defineProperty(r,"uri",{get:function(){if(d.url===e.location.href)return d.uri;var t;if(e.location.hash.length||"#"===e.location.href[p.href.length-1]){t=e.location.hash.match(/^(#*)?(.*\/?)/)[2];var n=r[v];r.beautifyLocation&&r.isPathValid&&n&&r.replaceState(r.state,r.title,"/"===t[0]?t:"/"+t)}else t=e.location.pathname+e.location.search,this.isPathValid&&(t=t.slice(this.basePath.length));return t=t.replace(/^[\/]+/,""),r.getAttribute("uri")!==t&&r.setAttribute("uri",t),d.url=e.location.href,d.uri=t,t},configurable:!0}),Object.defineProperty(r,"isPathValid",{get:function(){var t=e.location.pathname+e.location.search;return!this.basePath||0===t.indexOf(this.basePath)}}),r.eventStack={leave:[],change:[],enter:[],match:[]},e.addEventListener(E,function(){var t=r.uri,e=r.state;r.rulesDispatcher(),j=t,F=e,x&&this.dispatch()}.bind(r));var g=!1,m=function(){if(!g&&j!==r.uri){var t=r.uri,e=r.state;r.rulesDispatcher(),j=t,F=e,x&&this.dispatch()}}.bind(r);r.avoidHashchangeHandler=function(){e.removeEventListener(b,m),g=!0},e.addEventListener(b,m);var _=function(){e.dispatchEvent(new f(b))};return u.addEventListener("DOMContentLoaded",_),e.addEventListener("readystatechange",_),e.addEventListener("load",function(){_(),l&&e.setInterval(function(){return r.uri!==j?void _():void(g&&(g=!1,j=r.uri,e.addEventListener(b,m)))}.bind(r),50)}.bind(r)),this}function c(t){var n=t;this[t]=function(){var t=Array.prototype.slice.call(arguments);if(("pushState"===n||"replaceState"===n)&&!r(t[2])){if(o(t[2])){var i=this.uri.match(/^([^?#]*)\//);i=i?i[1]+"/":"",t[2]=i+t[2]}else t[2]=t[2].match(/^([#\/]*)?(.*)/)[2];this[v]?t[2]=this.basePath+t[2]:t[2]=p.pathname+"#"+a(t[2])}return e.history[n].apply(e.history,t),this}}var u=e.document,h=e.window,p=e.location,l=function(){var t=h.navigator.userAgent.indexOf("Trident");return t>=0}();!function(){e.location.origin||(e.location.origin=e.location.protocol+"//"+e.location.host)}(),function(){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,i=function(){},r=function(){var r=t;return this instanceof i&&t&&(r=this),n.apply(r,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,r.prototype=new i,r})}();var f=e.HashChangeEvent,d=e.Event;!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=u.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}if(Element.prototype.addEventListener){t.prototype=d.prototype,e.CustomEvent&&!l||(e.CustomEvent=t),(!f||e.opera&&e.opera.version()<15||l)&&(f=e.CustomEvent),l&&(d=t);try{new f("hashchange")}catch(n){f=t}try{new d("popstate")}catch(n){d=t}}}(),function(){if(!Element.prototype.addEventListener&&Object.defineProperty){var t=u.createEventObject().constructor.prototype;Object.defineProperty(t,"target",{get:function(){return this.srcElement}});var n=function(t,e){this.__bindedFunctions||(this.__bindedFunctions=[]);var n=e;if(!("on"+t in this)||"hashchange"===t){this.__elemetIEid=this.__elemetIEid||"__ie__"+Math.random();var i=t+this.__elemetIEid,r=this,o=function(t){t.propertyName===i&&n.call(r,u.documentElement[i])};if(this.__bindedFunctions.push({original:n,binded:o}),u.documentElement.attachEvent("onpropertychange",o),"hashchange"!==t)return}var a=n.bind(this);this.__bindedFunctions.push({original:n,binded:a}),this.attachEvent("on"+t,a)};HTMLDocument.prototype.addEventListener=n,Element.prototype.addEventListener=n,h.addEventListener=n;var i=function(t,e){this.__bindedFunctions||(this.__bindedFunctions=[]);var n,i=e;if(!("on"+t in this)||"hashchange"===t){for(var r=0;r<this.__bindedFunctions.length;r++)this.__bindedFunctions[r].original===i&&(n=this.__bindedFunctions[r].binded,this.__bindedFunctions=this.__bindedFunctions.splice(r,1),r=this.__bindedFunctions.length);if(n&&u.documentElement.detachEvent("onpropertychange",n),"hashchange"!==t)return}for(var o=0;o<this.__bindedFunctions.length;o++)this.__bindedFunctions[o].original===i&&(n=this.__bindedFunctions[o].binded,this.__bindedFunctions=this.__bindedFunctions.splice(o,1),o=this.__bindedFunctions.length);n&&this.detachEvent("on"+t,n)};HTMLDocument.prototype.removeEventListener=i,Element.prototype.removeEventListener=i,h.removeEventListener=i,d=function(t,n){var i=u.createEventObject();return n=n||{},i.type=t,i.detail=n.detail,"on"+t in e&&"hashchange"!==t||(i.name=t,i.customEvent=!0),i},CustomEvent=d,f=CustomEvent;var r=function(t){if(!t.customEvent)return void this.fireEvent(t.type,t);if(this.__elemetIEid){var e=t.name+this.__elemetIEid;u.documentElement[e]=t}};HTMLDocument.prototype.dispatchEvent=r,Element.prototype.dispatchEvent=r,h.dispatchEvent=r}}(),function(){var t="forEach"in Array.prototype;if(!t){var e=Array.prototype.slice;Array.prototype.slice=function(){for(var t=[],n=0,i=this.length;i>n;n++)n in this&&t.push(this[n]);return e.apply(t,arguments)}}"forEach"in Array.prototype||(Array.prototype.forEach=function(t,e){for(var n=0;n<this.length;n++)n in this&&t.call(e,this[n],n)}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.filter||(Array.prototype.filter=function(t){if(void 0===this||null===this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i=[],r=arguments.length>=2?arguments[1]:void 0,o=0;n>o;o++)if(o in e){var a=e[o];t.call(r,a,o,e)&&i.push(a)}return i})}();var v="usePushState",y="hasPushState",b="hashchange",E="popstate",g="leave",m="update",_="enter",P="change",w="match",S="oldMatch",L=e.PushStateTree&&e.PushStateTree.options||{},O=e.DEBUG||L.DEBUG,A="undefined"!=typeof HTMLElement?HTMLElement:Element,F=null,j=null,I=[],x=!1,C=!1;s.prototype={beautifyLocation:!0,createRule:function(t){var e=u.createElement("pushstatetree-rule"),i=new RegExp("");Object.defineProperty(e,"rule",{get:function(){return i},set:function(t){if(t instanceof RegExp)i=t;else{if(t===i.toString())return;var n=(t+"").match(/^\/(.+)\/([gmi]*)|(.*)/);i=new RegExp(n[1]||n[3],n[2])}e.setAttribute("rule",i.toString())}}),Object.defineProperty(e,"parentGroup",{get:function(){var t=e.getAttribute("parent-group");return t&&n(t)?+t:null},set:function(t){n(t)?e.setAttribute("parent-group",t):e.removeAttribute("parent-group")}});for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);var o=[];Object.defineProperty(e,w,{get:function(){return o},set:function(t){o=t instanceof Array?t:[]}});var a=[];return Object.defineProperty(e,S,{get:function(){return a},set:function(t){a=t instanceof Array?t:[]}}),e[w]=[],e[S]=[],["assign","navigate","replace","dispatch","pushState","replaceState"].forEach(function(t){e[t]=function(){this.parentElement[t].apply(this.parentElement,arguments)}}),e},add:function(t){return this.appendChild(this.createRule(t)),this},remove:function(t){var e=t;return"string"==typeof t&&(e=this.querySelector(t)),e&&e.parentElement?(e.parentElement.removeChild(e),e):void 0},dispatch:function(){return C?(x=!0,this):(x=!1,e.dispatchEvent(new d(E)),this)},assign:function(t){return this.pushState(null,null,t).dispatch()},replace:function(t){return this.replaceState(null,null,t).dispatch()},navigate:function(){this.assign.apply(this,arguments)},rulesDispatcher:function(){function t(t,e){return Array.prototype.slice.call(this.children||this.childNodes).forEach(n.bind(this,t,e)),t}function n(t,r,o){function a(t,n){n=n||{},n.detail=n.detail||{},n.detail[w]=h||[],n.detail[S]=p||[],n.cancelable=!0,i&&"object"==typeof console&&(console.log({name:t,ruleElement:o,params:n,useURI:c,useOldURI:u}),console.trace&&console.trace());var r=new e.CustomEvent(t,n);return r}if(o.rule){var s,c=t,u=r;"number"==typeof o.parentGroup&&(c="",s=o.parentElement,s[w].length>o.parentGroup&&(c=s[w][o.parentGroup]||""),u="",s[S].length>o.parentGroup&&(u=s[S][o.parentGroup]||"")),o[w]=c[w](o.rule),"string"==typeof u?o[S]=u[w](o.rule):o[S]=[];var h=o[w],p=o[S],l=Array.prototype.slice.call(o.children);if(0===h.length){if(0===p.length||o.routerURI!==r)return;return o.uri=null,o.removeAttribute("uri"),l.forEach(n.bind(this,t,r)),o.dispatchEvent(new a(m,{detail:{type:g}})),void o.dispatchEvent(new a(g))}this.eventStack[w].push({element:o,events:[new a(w)]});var f=o.routerURI!==r;if(o.routerURI=this.uri,o.uri=h[0],o.setAttribute("uri",h[0]),0===p.length||f)return this.eventStack[_].push({element:o,events:[new a(m,{detail:{type:_}}),new a(_)]}),void l.forEach(n.bind(this,t,r));h[0]!==p[0]&&this.eventStack[P].push({element:o,events:[new a(m,{detail:{type:P}}),new a(P)]}),l.forEach(n.bind(this,t,r))}}var i=this.debug===!0||O;if(this.isPathValid&&(I.push(t.bind(this,this.uri)),!(I.length>1))){for(var r=j;I.length>0;)r=I[0].call(null,r),I.shift();C=!0;var o=this.eventStack;[P,_,w].forEach(function(t){for(;o[t].length>0;){for(var e=o[t][0].events,n=o[t][0].element;e.length>0;)n.dispatchEvent(e[0]),e.shift();o[t].shift()}}),C=!1}}};for(var H in e.history)"function"==typeof e.history[H]&&c.call(s.prototype,H);s.prototype[y]=e.history&&!!e.history.pushState,s.prototype[y]||(s.prototype[v]=!1);var T=null;s.prototype.pushState||(s.prototype.pushState=function(t,n,i){var s=u.title||"";return i=i||"",null!==T&&(u.title=T),this.avoidHashchangeHandler(),r(i)&&(e.location.href=i),"#"===i[0]&&(i=i.slice(1)),o(i)&&(i=e.location.hash.slice(1,e.location.hash.lastIndexOf("/")+1)+i,i=a(i)),e.location.hash=i,u.title=s,T=n,this}),s.prototype.replaceState||(s.prototype.replaceState=function(t,n,i){var s=u.title||"";if(i=i||"",null!==T&&(u.title=T),this.avoidHashchangeHandler(),r(i))throw new Error("Invalid url replace.");if("#"===i[0]&&(i=i.slice(1)),o(i)){var c=e.location.hash.lastIndexOf("/")+1;i=e.location.hash.slice(1,c)+i,i=a(i)}return i="#"+i,e.location.replace(i),u.title=s,T=n,this}),e.PushStateTree=s,t.exports=s}(function(){return this}())}]);