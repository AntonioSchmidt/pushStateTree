!function(a){"use strict";function b(a,b,c){Object.defineProperty(a,b,{get:function(){return c},set:function(){}})}function c(a){return/^[a-z0-9]+:\/\//i.test(a)}function d(a){return"#"===a[0]&&(a=a.slice(1)),"/"!==a[0]}function e(c){if(c=c||{},t){for(var d in c)c.hasOwnProperty(d)&&(s[d]=c[d]);return s}t=!0,e.prototype.hasPushState?(Object.defineProperty(s,j,{get:function(){return e.prototype[j]},set:function(a){e.prototype[j]=a!==!1}}),e.prototype[j]=c[j]!==!1):b(s,j,!1),s.basePath=c.basePath||s.basePath||"";for(var d in e.prototype)e.prototype.hasOwnProperty(d)&&!function(a){if("function"==typeof e.prototype[a])s[a]=function(){return e.prototype[a].apply(this,arguments)};else{if("undefined"!=typeof s[a])return;Object.defineProperty(s,a,{get:function(){return e.prototype[a]},set:function(b){e.prototype[a]=b}})}}(d);b(s,"length",a.history.length),b(s,"state",a.history.state),Object.defineProperty(s,"uri",{get:function(){var a,b=location.href.indexOf("#");return-1!==b?(a=location.href.slice(b+1),a=a.replace(/^[#]+/,"")):(a=location.href.slice(location.origin.length),0===a.indexOf(this.basePath)&&(a=a.slice(this.basePath.length))),a=a.replace(/^[\/]+/,"")},configurable:!0}),a.addEventListener(l,function(){s.rulesDispatcher(),v=s.uri,u=s.state}.bind(s)),a.addEventListener(k,x);var f=function(){var b;b=new h(k),a.dispatchEvent(b)};return document.addEventListener("DOMContentLoaded",function(){f()}),a.addEventListener("readystatechange",function(){f()}),a.addEventListener("load",function(){f(),g&&a.setInterval(function(){return s.uri!==v?void f():void(y&&(y=!1,v=s.uri,a.addEventListener(k,x)))}.bind(s),50)}.bind(s)),new e(c)}function f(){a.removeEventListener(k,x),y=!0}var g=function(){var a=window.navigator.userAgent.indexOf("Trident");return a>=0}();!function(){a.location.origin||(a.location.origin=a.location.protocol+"//"+a.location.host)}(),function(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e})}();var h=a.HashChangeEvent,i=a.Event;!function(){function b(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}if(Element.prototype.addEventListener){b.prototype=i.prototype,(!a.CustomEvent||g)&&(a.CustomEvent=b),(!h||a.opera&&a.opera.version()<15||g)&&(h=a.CustomEvent),g&&(i=b);try{new h("hashchange")}catch(c){h=b}try{new i("popstate")}catch(c){i=b}}}(),function(){if(!Element.prototype.addEventListener&&Object.defineProperty){var b=document.createEventObject().constructor.prototype;Object.defineProperty(b,"target",{get:function(){return this.srcElement}});var c=function(a,b){this.__bindedFunctions||(this.__bindedFunctions=[]);var c=b;if(!("on"+a in this)||"hashchange"===a){this.__elemetIEid=this.__elemetIEid||"__ie__"+Math.random();var d=a+this.__elemetIEid;document.documentElement[d];var e=this,f=function(a){a.propertyName===d&&c.call(e,document.documentElement[d])};if(this.__bindedFunctions.push({original:c,binded:f}),document.documentElement.attachEvent("onpropertychange",f),"hashchange"!==a)return}var g=c.bind(this);this.__bindedFunctions.push({original:c,binded:g}),this.attachEvent("on"+a,g)};HTMLDocument.prototype.addEventListener=c,Element.prototype.addEventListener=c,window.addEventListener=c;var d=function(a,b){this.__bindedFunctions||(this.__bindedFunctions=[]);var c,d=b;if(!("on"+a in this)||"hashchange"===a){for(var e=0;e<this.__bindedFunctions.length;e++)this.__bindedFunctions[e].original===d&&(c=this.__bindedFunctions[e].binded,this.__bindedFunctions=this.__bindedFunctions.splice(e,1),e=this.__bindedFunctions.length);if(c&&document.documentElement.detachEvent("onpropertychange",c),"hashchange"!==a)return}for(var e=0;e<this.__bindedFunctions.length;e++)this.__bindedFunctions[e].original===d&&(c=this.__bindedFunctions[e].binded,this.__bindedFunctions=this.__bindedFunctions.splice(e,1),e=this.__bindedFunctions.length);c&&this.detachEvent("on"+a,c)};HTMLDocument.prototype.removeEventListener=d,Element.prototype.removeEventListener=d,window.removeEventListener=d,i=function(b,c){var d=document.createEventObject();return c=c||{},d.type=b,d.detail=c.detail,"on"+b in a&&"hashchange"!==b||(d.name=b,d.customEvent=!0),d},CustomEvent=i,h=CustomEvent;var e=function(a){if(!a.customEvent)return void this.fireEvent(a.type,a);if(this.__elemetIEid){var b=a.name+this.__elemetIEid;document.documentElement[b]=a}};HTMLDocument.prototype.dispatchEvent=e,Element.prototype.dispatchEvent=e,window.dispatchEvent=e}}(),function(){var a="forEach"in Array.prototype;if(!a){var b=Array.prototype.slice;Array.prototype.slice=function(){for(var a=[],c=0,d=this.length;d>c;c++)c in this&&a.push(this[c]);return b.apply(a,arguments)}}"forEach"in Array.prototype||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;d>c;c++)c in this&&a.call(b,this[c],c)}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d})}();var j="usePushState",k="hashchange",l="popstate",m="leave",n="update",o="enter",p="change",q="match",r="oldMatch",s=document.createElement("pushstatetree-route"),t=!1,u=null,v="";e.prototype={createRule:function(a){var b=document.createElement("pushstatetree-rule");for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);var d=[];Object.defineProperty(b,q,{get:function(){return d},set:function(a){d=a instanceof Array?a:[]}});var e=[];return Object.defineProperty(b,r,{get:function(){return e},set:function(a){e=a instanceof Array?a:[]}}),b[q]=[],b[r]=[],b},add:function(a){this.appendChild(this.createRule(a))},remove:function(a){var b=a;return"string"==typeof a&&(b=this.querySelector(a)),b&&b.parentElement?(b.parentElement.removeChild(b),b):void 0},dispatch:function(){var b;return b=new i(l),a.dispatchEvent(b),this},rulesDispatcher:function(){function b(c){function d(b,c){c=c||{},c.detail=c.detail||{},c.detail[q]=h||[],c.detail[r]=i||[],c.cancelable=!0;var d=new a.CustomEvent(b,c);return d}if(c.rule){var e,f=this.uri,g=v;"number"==typeof c.parentGroup&&(f="",e=c.parentElement,e[q].length>c.parentGroup&&(f=e[q][c.parentGroup]||""),g="",e[r].length>c.parentGroup&&(g=e[r][c.parentGroup]||"")),c[q]=f[q](c.rule),c[r]=g[q](c.rule);var h=c[q],i=c[r],j=Array.prototype.slice.call(c.children);if(0===h.length){if(0===i.length)return;return j.forEach(b.bind(this)),c.dispatchEvent(new d(m)),void c.dispatchEvent(new d(n,{detail:{type:m}}))}if(c.dispatchEvent(new d(q)),0===i.length)return c.dispatchEvent(new d(o)),c.dispatchEvent(new d(n,{detail:{type:o}})),void j.forEach(b.bind(this));h[0]!==i[0]&&(c.dispatchEvent(new d(p)),c.dispatchEvent(new d(n,{detail:{type:p}}))),j.forEach(b.bind(this))}}Array.prototype.slice.call(this.children||this.childNodes).forEach(b.bind(this))}};for(var w in a.history)"function"==typeof a.history[w]&&function(){var b=w;this[w]=function(){var e=Array.prototype.slice.call(arguments);return("pushState"===b||"replaceState"===b)&&(this[j]||c(e[2])||"#"===e[2][0]?c(e[2])||this.basePath&&!d(e[2])&&"#"!==e[2][0]&&(e[2]=this.basePath+e[2]):(d(e[2])&&(e[2]=a.location.hash.slice(1,a.location.hash.lastIndexOf("/")+1)+e[2]),e[2]="#"+e[2])),a.history[b].apply(a.history,e),this}}.bind(e.prototype)();var x=function(){y||v!==s.uri&&(s.rulesDispatcher(),v=s.uri,u=s.state)}.bind(s),y=!1;e.prototype.hasPushState=a.history&&!!a.history.pushState,e.prototype.hasPushState||(e.prototype[j]=!1);var z=null;e.prototype.pushState||(e.prototype.pushState=function(b,e,g){var h=document.title||"";return null!==z&&(document.title=z),f(),c(g)&&(a.location.href=g),"#"===g[0]&&(g=g.slice(1)),d(g)&&(g=a.location.hash.slice(1,a.location.hash.lastIndexOf("/")+1)+g),a.location.hash=g,document.title=h,z=e,this}),e.prototype.replaceState||(e.prototype.replaceState=function(b,e,g){var h=document.title||"";if(null!==z&&(document.title=z),f(),c(g))throw new Error("Invalid url replace.");if("#"===g[0]&&(g=g.slice(1)),d(g)){var i=a.location.hash.lastIndexOf("/")+1;g=a.location.hash.slice(1,i)+g}return g="#"+g,a.location.replace(g),document.title=h,z=e,this}),a.PushStateTree=e}(this);
//# sourceMappingURL=pushStateTree.map